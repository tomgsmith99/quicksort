<!DOCTYPE html>

<html>
    <head>
        <title>Tom's Quicksort</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel ="stylesheet" type ="text/css" href ="tsQuicksort.css">
        
        <script src ='binaryTree.js' type ='text/javascript'></script>
        <script src="jsplumb/jsPlumb-2.0.4.js"></script>
        <script src="jquery-2.1.4.min.js" type ="text/javascript"></script>
        
        <script type ="text/javascript">
            var qsCount = 0;

            var binaryTree = new BinaryTree();

            function quickSort(A, left, right) {
                var pivot;
                
                qsCount = qsCount + 1;
                console.log("----------QSBEGIN----------");
                console.log("Starting the qs function.");
                console.log("Iteration number: " + qsCount);
                console.log("The left index is: " + left);
                console.log("The right index is: " + right);
                console.log("Checking to see if left index < right index:");

                if (left < right) {
                    console.log("left is < right.");
                    console.log("starting the partition function.");
                    pivot = partition(A, left, right);
                    console.log("partition function complete.");
                    console.log("result of partition function - pivot index is: " + pivot);
                    quickSort (A, left, pivot);
                    quickSort (A, (pivot+1), right);
                }
                else if (left === right) { // Note: this clause is not needed for qs!
                    console.log("Nope. This partition is a singleton: " + A[left]);
                    var leaf = new Leaf();
                    leaf.setPreArray(A[left]);
                    binaryTree.addLeaf(leaf);
                }
                else { console.log("right > left, so we are done!"); } // also unnecessary
            }
            
            function partition(A, left, right){
                var pivot = A[left];
                var i = left;

                // Store the subarray in the binary tree
                // this procedure is not necessary for quicksort
                var leaf = new Leaf();
                binaryTree.addLeaf(leaf);
                leaf.setPreArray(A.slice(left, (right + 1)));

                console.log("--------PBEGIN------------");
                console.log("This is the partition we are going to work on:");

                printSubArray(A, left, right);

                for (j = left; j <= right; j++){
                    console.log("beginning state, at top of loop: ");
                    printSubArray(A, left, right);

                    console.log("The index of j is: " + j);
                    console.log("The index of i is: " + i);
                    console.log("Comparing A[" + j + "] (" + A[j] + ") to the pivot value: " + pivot);

                    if (A[j] <= pivot) {
                        console.log("A[j] is less than or equal to the pivot, so we are going to swap A[j] " + A[j] + " with A[i]: " + A[i]);

                        temp = A[j];
                        A[j] = A[i];
                        A[i] = temp;

                        console.log("end state, at bottom of loop:");
                        printSubArray(A, left, right);

                        i = i + 1;
                    }
                    else { console.log("A[j] is greater than the pivot value, so no values were swapped."); }
                    
                    console.log("i is now: " + i);
                    console.log("-----------------");
                }
                
                console.log("For loop complete. Swapping the A[i-1] value " + A[i-1] + " with the pivot " + A[left]);

                temp = A[i -1];
                A[i - 1] = A[left];
                A[left] = temp;
                
                console.log("This partition is now:");

                printSubArray(A, left, right);

                leaf.setPostArray(A.slice(left, (right + 1)));

                // Store the subarray in the binary tree
                // this procedure is not necessary for quicksort
                // thisArray = [];
                // for (k = left; k <= right; k++) { thisArray.push(A[k]); }
                
                // var leaf = new Leaf();
                // leaf.setData(thisArray);
                // binaryTree.addLeaf(leaf);

                console.log("The full array is now: " + A.join(' '));
                
                console.log("The length of the list of arrays is now: " + binaryTree.getTotal());

                retVal = i - 1;
                return retVal;
            }
            
            function printSubArray(A, l, r) { console.log(A.slice(l, r+1)); }
            
            window.onload = function () {
                var A = [17, 35, 12, 32, 6, 99, 4, 8, 43, 50];

                quickSort(A, 0, (A.length - 1));
                
                binaryTree.sortedInts = A;
                
                console.log("----------- COMPLETE! --------------------------");
                console.log("The sorted array is: " + binaryTree.sortedInts);

                binaryTree.showValues();

                binaryTree.build();

                binaryTree.calculateLeafDepths();

                binaryTree.flatten();

                binaryTree.show();
                
                binaryTree.buildDivs();

            };

        </script>
<!--            /*

            def quickSort(A, left, right): # Accept the array and arbitrary values for left
    # and right. In practice, left should always be less than right, except in
    # the case where the array has a length of 1, and in that case,
    # left is equal to right.

    if left < right: # this will always execute, unless 1) left > right, which
        # should not happen if we've constructed the Partition function properly
        # (and also passed in good values to start) or 2) left = right, in which case 
        
        pivot = partition(A, left, right) # get a pivot value between the left index and the right index
        printArray(A)
        printArray(A[left:pivot])
        quickSort (A, left, pivot)
        printArray(A[left:pivot])
        quickSort (A, (pivot+1), right)
        x = pivot + 1
        printArray(A[x:right])

def partition(A, left, right):
    pivot = A[left]

    while True:
        while A[right] > pivot:
            right = right - 1
        while A[left]  < pivot:
            left = left + 1
        if left < right:
            temp = A[left]
            A[left] = A[right]
            A[right] = temp
        else:
            # printArray(A)
            return right

quickSort(A, 0, (len(A) - 1))
# partition(A, 0, (len(A) - 1))

        </script>-->


    </head>
    <body>
        <div id="tomQS"></div>
    </body>
</html>